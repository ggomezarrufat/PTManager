<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test WebSocket</title>
    <script src="https://cdn.socket.io/4.8.1/socket.io.min.js"></script>
</head>
<body>
    <h1>Test WebSocket Connection</h1>
    <div id="status">Conectando...</div>
    <div id="messages"></div>

    <script>
        const statusDiv = document.getElementById('status');
        const messagesDiv = document.getElementById('messages');

        function log(message) {
            console.log(message);
            messagesDiv.innerHTML += '<div>' + message + '</div>';
        }

        try {
            log('Intentando conectar a http://localhost:3001...');
            const socket = io('http://localhost:3001');

            socket.on('connect', () => {
                statusDiv.textContent = '‚úÖ Conectado';
                statusDiv.style.color = 'green';
                log('‚úÖ WebSocket conectado exitosamente');

                // Intentar unirse al torneo
                socket.emit('join-tournament', {
                    tournamentId: 'f2c4e932-3b85-4d91-a528-4b5e278fbf9a',
                    userId: 'test-user-id'
                });
                log('üì§ Enviando solicitud de uni√≥n al torneo...');
            });

            socket.on('disconnect', () => {
                statusDiv.textContent = '‚ùå Desconectado';
                statusDiv.style.color = 'red';
                log('üîå WebSocket desconectado');
            });

            socket.on('connect_error', (error) => {
                statusDiv.textContent = '‚ùå Error de conexi√≥n';
                statusDiv.style.color = 'red';
                log('‚ùå Error de conexi√≥n WebSocket: ' + error.message);
            });

            socket.on('clock-sync', (state) => {
                log('üîÑ Estado del reloj recibido: ' + JSON.stringify(state, null, 2));
            });

            socket.on('error', (error) => {
                log('‚ùå Error del servidor: ' + error.message);
            });

        } catch (error) {
            statusDiv.textContent = '‚ùå Error al crear socket';
            statusDiv.style.color = 'red';
            log('‚ùå Error al crear socket: ' + error.message);
        }
    </script>
</body>
</html>
